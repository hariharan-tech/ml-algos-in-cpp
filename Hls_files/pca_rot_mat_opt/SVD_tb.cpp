#include<iostream>
#include "SVD_top.h"

//#define DIM 4

int main(void)
{
  float a[DIM*DIM]= {0.7016083 , 0.42785743, 0.25512168, 0.01223199, 0.42785743,
				       0.29104942, 0.59649056, 0.13261513, 0.25512168, 0.59649056,
				       0.04787561, 0.44952226, 0.01223199, 0.13261513, 0.44952226,
				       0.7467613 };
//
//	float a[DIM*DIM]= {0.503835  , 0.9355842 , 0.953972  , 0.33422518, 0.5711793 ,
//		       0.8042752 , 0.980986  , 0.8583856 , 0.3060989 , 0.53269196,
//		       0.06174436, 0.86542773, 0.84242594, 0.94639796, 0.7485421 ,
//		       0.9355842 , 0.1101497 , 0.9864135 , 0.5014259 , 0.26593226,
//		       0.3392466 , 0.5314261 , 0.9829542 , 0.07260937, 0.77934283,
//		       0.78807455, 0.9267518 , 0.24562061, 0.8046551 , 0.04678277,
//		       0.953972  , 0.9864135 , 0.7692478 , 0.56437206, 0.50158906,
//		       0.48653182, 0.68068284, 0.79480606, 0.14180475, 0.05267152,
//		       0.5543017 , 0.45673102, 0.710187  , 0.97818357, 0.38168466,
//		       0.33422518, 0.5014259 , 0.56437206, 0.8472722 , 0.59632045,
//		       0.39560658, 0.7819074 , 0.22753555, 0.5322465 , 0.48172098,
//		       0.94241697, 0.7744959 , 0.95628566, 0.4069445 , 0.9093959 ,
//		       0.5711793 , 0.26593226, 0.50158906, 0.59632045, 0.23741172,
//		       0.05559118, 0.50143856, 0.11379261, 0.4574115 , 0.7300452 ,
//		       0.13398051, 0.31015885, 0.91854584, 0.5510503 , 0.7983847 ,
//		       0.8042752 , 0.3392466 , 0.48653182, 0.39560658, 0.05559118,
//		       0.3130287 , 0.6202683 , 0.9407724 , 0.40616187, 0.72640836,
//		       0.44199154, 0.6038176 , 0.38019446, 0.41183633, 0.27003142,
//		       0.980986  , 0.5314261 , 0.68068284, 0.7819074 , 0.50143856,
//		       0.6202683 , 0.35154924, 0.1437789 , 0.99511015, 0.2050128 ,
//		       0.47240967, 0.12355002, 0.10807756, 0.20181388, 0.6046433 ,
//		       0.8583856 , 0.9829542 , 0.79480606, 0.22753555, 0.11379261,
//		       0.9407724 , 0.1437789 , 0.7058413 , 0.46841097, 0.5579322 ,
//		       0.20421518, 0.9745761 , 0.9085669 , 0.33698344, 0.1567949 ,
//		       0.3060989 , 0.07260937, 0.14180475, 0.5322465 , 0.4574115 ,
//		       0.40616187, 0.99511015, 0.46841097, 0.6644227 , 0.8439967 ,
//		       0.7348432 , 0.5056509 , 0.52478206, 0.04892552, 0.5096049 ,
//		       0.53269196, 0.77934283, 0.05267152, 0.48172098, 0.7300452 ,
//		       0.72640836, 0.2050128 , 0.5579322 , 0.8439967 , 0.4028809 ,
//		       0.22280386, 0.20460154, 0.52577347, 0.14598744, 0.89472324,
//		       0.06174436, 0.78807455, 0.5543017 , 0.94241697, 0.13398051,
//		       0.44199154, 0.47240967, 0.20421518, 0.7348432 , 0.22280386,
//		       0.21395533, 0.01715267, 0.48336193, 0.5570688 , 0.24414288,
//		       0.86542773, 0.9267518 , 0.45673102, 0.7744959 , 0.31015885,
//		       0.6038176 , 0.12355002, 0.9745761 , 0.5056509 , 0.20460154,
//		       0.01715267, 0.13263962, 0.6930434 , 0.8779945 , 0.62739396,
//		       0.84242594, 0.24562061, 0.710187  , 0.95628566, 0.91854584,
//		       0.38019446, 0.10807756, 0.9085669 , 0.52478206, 0.52577347,
//		       0.48336193, 0.6930434 , 0.11439001, 0.19757108, 0.92240316,
//		       0.94639796, 0.8046551 , 0.97818357, 0.4069445 , 0.5510503 ,
//		       0.41183633, 0.20181388, 0.33698344, 0.04892552, 0.14598744,
//		       0.5570688 , 0.8779945 , 0.19757108, 0.3469131 , 0.14537218,
//		       0.7485421 , 0.04678277, 0.38168466, 0.9093959 , 0.7983847 ,
//		       0.27003142, 0.6046433 , 0.1567949 , 0.5096049 , 0.89472324,
//		       0.24414288, 0.62739396, 0.92240316, 0.14537218, 0.5224271};



//  float a[DIM*DIM]={1495.49634046,  309.44840367, -256.54011703,   28.99168192,
//		     1140.90221941,  457.67142616,  123.33678716, -142.83158187,
//	       1154.33849802,  621.24460489,  211.35741969,  -53.51181422,
//	       1034.75280391,  844.73903111,   55.5735673 ,   15.48632518,
//	        464.53248393,  248.77696148,  256.53914198,  378.39526169,
//	       -705.80205152,   -1.74019366,   55.5735673 ,  309.44840367,
//	        729.87460811,  178.15061031,  206.22329118,  532.70244225,
//	        233.39545375,  389.31025275,  261.23471257,  215.37562191,
//	        242.52634424,  387.35426723,  130.23389983,  482.23230564,
//	        228.32045674,  258.4349227 ,   17.66901942,  286.31517089,
//	        459.63673653, -178.15099469, -258.69941048,  313.04706449,
//	       -175.74473892,  258.4349227 , -256.54011703,  178.15061031,
//	        515.56702808,  247.92112153,    8.9740023 ,   71.05466975,
//	        348.88365935,  258.60354916, -200.48616452,  -40.49262123,
//	        240.01940281,  219.32252325,  -82.21952501,  -36.83421724,
//	        219.41701001,  118.38121532,    2.88861154,  350.969791  ,
//	       -515.56767201, -159.68712938,  502.47734442,  -53.96164147,
//	        219.41701001,   28.99168192,  206.22329118,  247.92112153,
//	        562.99770067,  188.36217643,  137.05670651,  393.17801407,
//	        333.62166154,   42.04847526,  158.51952265,  234.83935968,
//	        212.67323171,  163.11619331,  138.6586134 ,  150.64500552,
//	        202.85283218,  114.01102159,  449.07921016, -247.92180602,
//	        -16.5981743 ,  378.08655319,  -28.45305741,  150.64500552,
//	       1140.90221941,  532.70244225,    8.9740023 ,  188.36217643,
//	       1167.82127919,  391.82050287,  285.51610922,   26.30013478,
//	        932.89330307,  509.52126482,  351.96441659,  -17.37298755,
//	        899.73625441,  689.85935218,  164.71812981,   37.83226455,
//	        430.9850477 ,  416.13792733,   -8.975258  ,  126.35297067,
//	       -214.86212343,  -82.59888362,  164.71812981,  457.67142616,
//	        233.39545375,   71.05466975,  137.05670651,  391.82050287,
//	        433.18911765,  165.14603217,  -89.88298047,  347.44777406,
//	        257.13300696,  124.64902737,  -86.22079762,  455.39757706,
//	        261.86951852,   50.70407342, -120.69045895,  316.64865744,
//	        189.36350932,  -71.05479348,   49.97341877,  268.70692416,
//	        -18.28464316,   50.70407342,  123.33678716,  389.31025275,
//	        348.88365935,  393.17801407,  285.51610922,  165.14603217,
//	        587.27601108,  219.88618823,   56.28340198,  239.75850313,
//	        483.40972284,  277.90971964,  173.63308972,  311.41051582,
//	        331.89724536,  249.47900516,  151.32262106,  709.9322507 ,
//	       -348.88443523, -127.81444603,  205.41318754,  -33.69024256,
//	        331.89724536, -142.83158187,  261.23471257,  258.60354916,
//	        333.62166154,   26.30013478,  -89.88298047,  219.88618823,
//	        553.60691784, -123.21052894,  -22.97413677,  113.66399409,
//	        339.16194328,   66.49839781,  -83.33432584,  137.9872488 ,
//	        192.79116456,  -33.15414613,  197.26584133, -258.60408312,
//	        -98.76917566,  223.72952792, -120.28054699,  137.9872488 ,
//	       1154.33849802,  215.37562191, -200.48616452,   42.04847526,
//	        932.89330307,  347.44777406,   56.28340198, -123.21052894,
//	       1103.77873333,  434.36203934,    8.50719799, -113.78034083,
//	        926.47941125,  629.27905614,  -93.25799172,  -17.80584564,
//	        375.16102768,   67.83199663,  200.48503262,  366.31254502,
//	       -409.73687564,    2.09167964,  -93.25799172,  621.24460489,
//	        242.52634424,  -40.49262123,  158.51952265,  509.52126482,
//	        257.13300696,  239.75850313,  -22.97413677,  434.36203934,
//	        431.13649381,  244.6335957 ,    6.40287945,  440.95058927,
//	        516.71260048,  139.54928365,   27.67763622,  308.80604536,
//	        337.66857854,   40.49222607,   55.61920622, -200.00869158,
//	         30.07501546,  139.54928365,  211.35741969,  387.35426723,
//	        240.01940281,  234.83935968,  351.96441659,  124.64902737,
//	        483.40972284,  113.66399409,    8.50719799,  244.6335957 ,
//	        680.71714359,  266.19703281,   28.67200205,  374.83793975,
//	        506.62490446,  297.6220358 ,   71.49956274,  770.86653683,
//	       -240.01972754, -177.29835955, -252.79775182,    3.10328883,
//	        506.62490446,  -53.51181422,  130.23389983,  219.32252325,
//	        212.67323171,  -17.37298755,  -86.22079762,  277.90971964,
//	        339.16194328, -113.78034083,    6.40287945,  266.19703281,
//	        757.66465844,   -6.04236131,   50.19639969,  376.76686497,
//	        498.93431047, -134.9687527 ,  400.80997269, -219.32301729,
//	         49.31691242, -371.97418827,   14.9682284 ,  376.76686497,
//	       1034.75280391,  482.23230564,  -82.21952501,  163.11619331,
//	        899.73625441,  455.39757706,  173.63308972,   66.49839781,
//	        926.47941125,  440.95058927,   28.67200205,   -6.04236131,
//	       1265.15029384,  353.61203168, -162.82793796,  -47.44929177,
//	        517.45691871,  142.89298557,   82.21856728,  282.62954382,
//	        233.0108959 , -221.43077163, -162.82793796,  844.73903111,
//	        228.32045674,  -36.83421724,  138.6586134 ,  689.85935218,
//	        261.86951852,  311.41051582,  -83.33432584,  629.27905614,
//	        516.71260048,  374.83793975,   50.19639969,  353.61203168,
//	        993.64182931,  237.1179344 ,   -5.75447655,  283.20271769,
//	        484.1206602 ,   36.83350332,  104.60065289, -566.05466116,
//	        225.55408555,  237.1179344 ,   55.5735673 ,  258.4349227 ,
//	        219.41701001,  150.64500552,  164.71812981,   50.70407342,
//	        331.89724536,  137.9872488 ,  -93.25799172,  139.54928365,
//	        506.62490446,  376.76686497, -162.82793796,  237.1179344 ,
//	        661.98966278,  194.75414087,  -14.29982161,  533.75358098,
//	       -219.4172636 , -209.86606385, -348.06496629,   40.95956544,
//	        661.98966278,   15.48632518,   17.66901942,  118.38121532,
//	        202.85283218,   37.83226455, -120.69045895,  249.47900516,
//	        192.79116456,  -17.80584564,   27.67763622,  297.6220358 ,
//	        498.93431047,  -47.44929177,   -5.75447655,  194.75414087,
//	        669.88834292, -160.41463549,  427.21189339, -118.38164659,
//	        120.14834798, -556.02534716,    0.43836595,  194.75414087,
//	        464.53248393,  286.31517089,    2.88861154,  114.01102159,
//	        430.9850477 ,  316.64865744,  151.32262106,  -33.15414613,
//	        375.16102768,  308.80604536,   71.49956274, -134.9687527 ,
//	        517.45691871,  283.20271769,  -14.29982161, -160.41463549,
//	        410.78002083,  103.61575956,   -2.88872122,   -8.55391558,
//	        281.41803106,  -70.25774435,  -14.29982161,  248.77696148,
//	        459.63673653,  350.969791  ,  449.07921016,  416.13792733,
//	        189.36350932,  709.9322507 ,  197.26584133,   67.83199663,
//	        337.66857854,  770.86653683,  400.80997269,  142.89298557,
//	        484.1206602 ,  533.75358098,  427.21189339,  103.61575956,
//	       1071.86963186, -350.97094582, -128.65289449, -116.16995966,
//	         10.90053126,  533.75358098,  256.53914198, -178.15099469,
//	       -515.56767201, -247.92180602,   -8.975258  ,  -71.05479348,
//	       -348.88443523, -258.60408312,  200.48503262,   40.49222607,
//	       -240.01972754, -219.32301729,   82.21856728,   36.83350332,
//	       -219.4172636 , -118.38164659,   -2.88872122, -350.97094582,
//	        515.56831606,  159.68692096, -502.47761245,   53.96163415,
//	       -219.4172636 ,  378.39526169, -258.69941048, -159.68712938,
//	        -16.5981743 ,  126.35297067,   49.97341877, -127.81444603,
//	        -98.76917566,  366.31254502,   55.61920622, -177.29835955,
//	         49.31691242,  282.62954382,  104.60065289, -209.86606385,
//	        120.14834798,   -8.55391558, -128.65289449,  159.68692096,
//	        470.83109061, -401.75540032,   38.13255394, -209.86606385,
//	       -705.80205152,  313.04706449,  502.47734442,  378.08655319,
//	       -214.86212343,  268.70692416,  205.41318754,  223.72952792,
//	       -409.73687564, -200.00869158, -252.79775182, -371.97418827,
//	        233.0108959 , -566.05466116, -348.06496629, -556.02534716,
//	        281.41803106, -116.16995966, -502.47761245, -401.75540032,
//	       2342.84521726, -314.60028792, -348.06496629,   -1.74019366,
//	       -175.74473892,  -53.96164147,  -28.45305741,  -82.59888362,
//	        -18.28464316,  -33.69024256, -120.28054699,    2.09167964,
//	         30.07501546,    3.10328883,   14.9682284 , -221.43077163,
//	        225.55408555,   40.95956544,    0.43836595,  -70.25774435,
//	         10.90053126,   53.96163415,   38.13255394, -314.60028792,
//	        249.93981767,   40.95956544,   55.5735673 ,  258.4349227 ,
//	        219.41701001,  150.64500552,  164.71812981,   50.70407342,
//	        331.89724536,  137.9872488 ,  -93.25799172,  139.54928365,
//	        506.62490446,  376.76686497, -162.82793796,  237.1179344 ,
//	        661.98966278,  194.75414087,  -14.29982161,  533.75358098,
//	       -219.4172636 , -209.86606385, -348.06496629,   40.95956544,
//	        661.98966278};

//  float eig_vector[DIM*DIM], eig_value[DIM],sorted_eigenval[DIM],
  float sorted_eigvec[L_MAX*DIM], comp;
  int index;

  float abs_diff = 0.0f, temp;
  s_packet test_input, test_output;
  stream_port input_stream, output_stream;
  for(int i=0;i<DIM*DIM;i++){
	  test_input.data = a[i];
	  test_input.last = (i==DIM*DIM-1)?(1):(0);
	  input_stream.write(test_input);
  }

  svd_sort_select(input_stream,output_stream,index,comp);



  do{

	  for (int i=0;i<DIM;i++){
		  for (int j=0;j<L_MAX;j++){
			 test_output=output_stream.read();
	         std::cout<<test_output.data<<" ";
		  }
	  std::cout<<std::endl;
	  }
  }while(!test_output.last);


   std::cout<<std::endl<<comp;
   return 0;
}
